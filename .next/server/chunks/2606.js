exports.id=2606,exports.ids=[2606],exports.modules={2606:(e,r,t)=>{"use strict";t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{default:()=>h});var a=t(997),o=t(6689),n=t(3590);t(8819),t(1791);var i=t(2586),l=t.n(i),c=t(5284),d=t(8538),m=t(7868),u=e([n]);n=(u.then?(await u)():u)[0];let h=({onSendSuccess:e})=>{let[r,t]=(0,o.useState)(""),[s,i]=(0,o.useState)(""),[u,h]=(0,o.useState)([]),[p,x]=(0,o.useState)(!1),[g,b]=(0,o.useState)(null),[f,j]=(0,o.useState)("marketing"),[y,w]=(0,o.useState)(""),[N,v]=(0,o.useState)([]),[E,S]=(0,o.useState)(""),[C,k]=(0,o.useState)(!1),[D,T]=(0,o.useState)([]),O={marketing:`
      <p>\xa1Hola, {{name}}!</p>
      <p>Queremos informarte sobre nuestras ofertas exclusivas para ti.</p>
      <p>No te pierdas nuestras promociones especiales. Vis\xedtanos hoy mismo.</p>
      <p>\xa1Gracias por ser parte de nuestra comunidad!</p>
    `,payment:`
      <p>Estimado {{name}},</p>
      <p>Este es un recordatorio de que tu pago est\xe1 pendiente. Por favor, realiza el pago lo antes posible.</p>
      <p>Detalles del pago:</p>
      <p>Asunto: Pago pendiente</p>
      <p>Gracias por tu atenci\xf3n.</p>
    `,info:`
      <p>Hola {{name}},</p>
      <p>Te estamos enviando este correo para mantenerte informado sobre las \xfaltimas actualizaciones.</p>
      <p>Visita nuestro sitio web para m\xe1s detalles.</p>
      <p>\xa1Gracias por seguir con nosotros!</p>
    `};(0,o.useEffect)(()=>{(async()=>{try{let e=await (0,d.Rf)();v(e)}catch(e){console.error("Error obteniendo usuarios:",e),b("No se pudieron cargar los usuarios.")}})()},[]),(0,o.useEffect)(()=>{w(O[f])},[f]),(0,o.useEffect)(()=>{(async()=>{try{let e=await (0,m.G5)();T(e)}catch(e){console.error("Error obteniendo correos:",e),b("No se pudieron cargar los correos.")}})()},[]);let P=(e,r)=>{r?h(r=>[...r,e]):h(r=>r.filter(r=>r.id!==e.id))},A=e=>{k(e),e?h(N):h([])},$=async e=>{let r=D[e];console.log("Este es el emailToDelete ",r);try{await (0,m.nd)(r.id),T(r=>r.filter((r,t)=>t!==e)),n.toast.success("Correo eliminado exitosamente")}catch(e){console.error("Error al eliminar el correo:",e),n.toast.error("Ocurri\xf3 un error al eliminar el correo")}},L=async t=>{if(t.preventDefault(),0===u.length){n.toast.error("Por favor, selecciona al menos un usuario.");return}x(!0),b(null);try{await Promise.all(u.map(async e=>{let t=y.replace("{{name}}",e.name),a={userName:e.name,email:e.email,subject:r,type:f,content:t,createdAt:s?new Date(s).toISOString():new Date().toISOString()},o=new Date().toISOString().split("T")[0],i=new Date(a.createdAt).toISOString().split("T")[0];console.log("comparaciom ",i,o),i===o?(await (0,c.C)(r,t,e.email),await (0,m.D$)(a),T(e=>[...e,a]),n.toast.success("Correos enviados exitosamente")):(await (0,m.D$)(a),T(e=>[...e,a]),n.toast.info("Se creo correctamente, se enviar\xe1 la fecha correspondiente."))})),e()}catch(e){e instanceof Error?(b(e.message),n.toast.error(e.message)):(n.toast.error("Ocurri\xf3 un error desconocido"),b("Ocurri\xf3 un error desconocido"))}finally{x(!1)}},I=N.filter(e=>e.name.toLowerCase().includes(E.toLowerCase())||e.email.toLowerCase().includes(E.toLowerCase()));return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-8",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto p-10 bg-white shadow-lg rounded-lg",children:[a.jsx("h1",{className:"text-4xl font-semibold text-center text-gray-800 mb-8",children:"Enviar Correos Personalizados"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[(0,a.jsxs)("div",{className:"p-8 bg-gray-100 rounded-lg shadow-md",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Vista Previa y Edici\xf3n"}),a.jsx(l(),{theme:"snow",value:y,onChange:w,className:"h-96 border rounded-md overflow-y-auto"})]}),a.jsx("div",{className:"space-y-8",children:(0,a.jsxs)("form",{onSubmit:L,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700",children:"Asunto:"}),a.jsx("input",{type:"text",id:"subject",className:"mt-1 p-3 w-full text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",value:r,onChange:e=>t(e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"scheduleDate",className:"block text-sm font-medium text-gray-700",children:"Enviar Programado:"}),a.jsx("input",{type:"datetime-local",id:"scheduleDate",className:"mt-1 p-3 w-full text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",value:s,onChange:e=>i(e.target.value)})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"currentDate",className:"block text-sm font-medium text-gray-700",children:"Fecha Actual:"}),a.jsx("button",{type:"button",id:"currentDate",className:"mt-1 p-2 bg-gray-300 text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:()=>i(new Date().toISOString().slice(0,16)),children:"Actual"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"template",className:"block text-sm font-medium text-gray-700",children:"Seleccionar Plantilla:"}),(0,a.jsxs)("select",{id:"template",className:"mt-1 p-3 w-full text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",value:f,onChange:e=>j(e.target.value),children:[a.jsx("option",{value:"marketing",children:"Marketing"}),a.jsx("option",{value:"payment",children:"Aviso de Pago"}),a.jsx("option",{value:"info",children:"Informaci\xf3n"})]})]}),a.jsx("div",{children:a.jsx("input",{type:"text",placeholder:"Filtrar usuarios por nombre o correo",className:"mt-1 p-3 w-full text-sm border border-gray-300 rounded-md shadow-sm",value:E,onChange:e=>S(e.target.value)})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Selecciona Usuarios:"}),a.jsx("div",{className:"overflow-y-auto max-h-80",children:(0,a.jsxs)("table",{className:"w-full mt-2 border text-sm",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"p-3 border",children:a.jsx("input",{type:"checkbox",checked:C,onChange:e=>A(e.target.checked)})}),a.jsx("th",{className:"p-3 border",children:"Nombre"}),a.jsx("th",{className:"p-3 border",children:"Email"})]})}),a.jsx("tbody",{children:I.map(e=>(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"p-3 border text-center",children:a.jsx("input",{type:"checkbox",checked:u.some(r=>r.id===e.id),onChange:r=>P(e,r.target.checked)})}),a.jsx("td",{className:"p-3 border",children:e.name}),a.jsx("td",{className:"p-3 border",children:e.email})]},e.id))})]})})]}),g&&a.jsx("p",{className:"text-red-500 text-xs",children:g}),a.jsx("div",{className:"flex justify-center",children:a.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-3 rounded-lg text-sm font-semibold hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-500 disabled:bg-gray-300",disabled:p,children:p?"Enviando...":"Enviar Correos"})})]})}),(0,a.jsxs)("div",{className:"col-span-1 lg:col-span-1 mt-8 lg:mt-0 max-h-96 overflow-y-auto",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Correos Enviados:"}),(0,a.jsxs)("table",{className:"w-full mt-2 border text-sm",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"p-3 border",children:"Asunto"}),a.jsx("th",{className:"p-3 border",children:"Destinatario"}),a.jsx("th",{className:"p-3 border",children:"Fecha de Env\xedo"}),a.jsx("th",{className:"p-3 border",children:"Tipo"}),a.jsx("th",{className:"p-3 border",children:"Acciones"})]})}),a.jsx("tbody",{children:D.map((e,r)=>(0,a.jsxs)("tr",{children:[a.jsx("td",{className:"p-3 border",children:e.subject}),a.jsx("td",{className:"p-3 border",children:e.email}),a.jsx("td",{className:"p-3 border",children:new Date(e.createdAt).toLocaleString()}),a.jsx("td",{className:"p-3 border",children:e.type}),a.jsx("td",{className:"p-3 border text-center",children:a.jsx("button",{className:"bg-red-500 text-white px-3 py-2 rounded hover:bg-red-600",onClick:()=>$(r),children:"Eliminar"})})]},r))})]})]})]}),a.jsx(n.ToastContainer,{})]})})};s()}catch(e){s(e)}})},5284:(e,r,t)=>{"use strict";t.d(r,{C:()=>s});let s=async(e,r,t)=>{let s=await fetch("http://localhost:3000/api/v1/emails",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:e,html:r,recipientEmail:t})});if(!s.ok)throw Error((await s.json()).message||"Error enviando correo");return s.json()}},7868:(e,r,t)=>{"use strict";t.d(r,{D$:()=>o,G5:()=>a,nd:()=>n});let s="http://localhost:3000/api/v1";async function a(){let e=await fetch(`${s}/email`);if(!e.ok)throw Error("Error al obtener los correos");return await e.json()}async function o(e){let r=await fetch(`${s}/email`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw Error("Error al crear el correo");return await r.json()}async function n(e){let r=await fetch(`${s}/email/${e}`,{method:"DELETE"});if(!r.ok)throw Error("Error al eliminar el correo");return await r.json()}},8538:(e,r,t)=>{"use strict";t.d(r,{Nq:()=>i,Rf:()=>a,h8:()=>n,r4:()=>o});let s=process.env.NEXT_PUBLIC_API_URL||"http://localhost:3000/api/v1/users",a=async()=>{try{let e=await fetch(s,{method:"GET"});if(!e.ok){let r=await e.json();throw Error(r.message||"Error fetching users")}return await e.json()}catch(e){throw console.error("Error fetching users:",e),e}},o=async e=>{try{console.log("Este es el usuario ",e);let r=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok){let e=await r.json();throw Error(e.message||"Error creating user")}return await r.json()}catch(e){throw console.error("Error creating user:",e),e}},n=async e=>{try{let r=await fetch(`${s}/${e}`,{method:"DELETE"});if(!r.ok){let e=await r.json();throw Error(e.message||"Error deleting user")}return await r.json()}catch(e){throw console.error("Error deleting user:",e),e}},i=async(e,r)=>{try{let t=await fetch(`${s}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!t.ok){let e=await t.json();throw Error(e.message||"Error updating user")}return await t.json()}catch(e){throw console.error("Error updating user:",e),e}}},1791:()=>{},8819:()=>{}};